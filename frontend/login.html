<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DSRT Login</title>
<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

const supabaseUrl = 'https://rahhhdsftzglqcpoyzoq.supabase.co'
const supabaseKey = 'sb_publishable_sNPlskS6PEOQp2P-IY4zAw_3UWG5NIp'
const supabase = createClient(supabaseUrl, supabaseKey)

async function loginEmail() {
  const email = document.getElementById('emailLogin').value
  const password = document.getElementById('passwordLogin').value
  const { data, error } = await supabase.auth.signInWithPassword({ email, password })
  if(error) alert(error.message)
  else {
    alert('Login berhasil!')
    localStorage.setItem('session', JSON.stringify(data.session))
    location.href='dashboard.html'
  }
}

async function loginPhone() {
  const phone = document.getElementById('phoneLogin').value
  const password = document.getElementById('phonePasswordLogin').value
  const { data, error } = await supabase.auth.signInWithPassword({ email: null, password, phone })
  if(error) alert(error.message)
  else {
    alert('Login berhasil!')
    localStorage.setItem('session', JSON.stringify(data.session))
    location.href='dashboard.html'
  }
}

window.loginEmail = loginEmail
window.loginPhone = loginPhone
</script>
</head>
<body>
<h1>DSRT Login</h1>
<h3>Login via Email</h3>
<input id="emailLogin" placeholder="Email"><br>
<input id="passwordLogin" type="password" placeholder="Password"><br>
<button onclick="loginEmail()">Login Email</button>

<h3>Login via Phone</h3>
<input id="phoneLogin" placeholder="Phone +62xxx"><br>
<input id="phonePasswordLogin" type="password" placeholder="Password"><br>
<button onclick="loginPhone()">Login Phone</button>
</body>
</html>
